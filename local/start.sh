#!/bin/bash

# 1. –£–±–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (—á–∏—Å—Ç–∫–∞)
echo "üßπ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤..."
pkill -f ngrok
pkill -f media_choose.py
pkill -f voise_intension_vosk.py

# 2. –ó–∞–ø—É—Å–∫–∞–µ–º ngrok (–¢—É–Ω–Ω–µ–ª—å)
echo "üöÄ –ó–∞–ø—É—Å–∫ ngrok..."
nohup ngrok http 5000 > /dev/null 2>&1 &

# –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
echo "‚è≥ –ñ–¥–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª—è (5 —Å–µ–∫)..."
sleep 5

# 3. –ó–∞–ø—É—Å–∫–∞–µ–º –ì–æ–ª–æ—Å–æ–≤–æ–π –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç (Vosk) –≤ —Ñ–æ–Ω–µ
# –ú—ã –ø–∏—à–µ–º –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª /tmp/voice.log, —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å —ç–∫—Ä–∞–Ω
echo "üé§ –ó–∞–ø—É—Å–∫ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Vosk)..."
nohup python3 voise_intension_vosk.py > /tmp/voice.log 2>&1 &

# 4. –ó–∞–ø—É—Å–∫–∞–µ–º –ú–µ–¥–∏–∞ –ü–ª–µ–µ—Ä (–ì–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å)
# –û–Ω —Å–∞–º –Ω–∞–π–¥–µ—Ç ngrok –∏ –æ–±–Ω–æ–≤–∏—Ç —Å–µ—Ä–≤–µ—Ä
echo "üé¨ –ó–∞–ø—É—Å–∫ –º–µ–¥–∏–∞-–ø–ª–µ–µ—Ä–∞..."
python3 media_choose.py